---
title: "Covid-19 Cases and Vaccination Rates"
author: "Kongtao Chen, Eric Shin, Laith Darwish"
date: "2/16/2022"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library('tidyverse') ; library('modeldata') ; library('ggplot2');
library('jsonlite') ; library('rgdal') ; library('sf'); library('extrafont') ; library('ggplot2') ; library('ggspatial');
library('patchwork') ; library('scico') ; library('dplyr'); library('flexdashboard');
#library(urbnmapr)
library('here')
library('maps')
library('albersusa')

options(digits = 3)
set.seed(1234)
theme_set(theme_minimal())
```

## Introduction

This R Markdown document demonstrates our abilities to use models for data analysis using a data set collected on Covid-19 vaccination rates, cases, and some data related to them.

```{r load data, include = FALSE}
vac_base <- read.csv("Vaccination_Base.csv", row.names=NULL)
#vac_rates <- vac_base$Admin_Per_100K
#vac_rates <- cbind(vac_base$Location, vac_base$Admin_Per_100K)
vac_rates <- vac_base %>% 
  select(State_Abbreviations, Location, Admin_Per_100K)
rate_case <- vac_base %>% 
  select(State_Abbreviations, Location, Total_Cases, Admin_Per_100K)
```

## What is that sound?

In this report, we examine the relationship between vaccine coverage and confirmed cases in US states. And further compare the vaccine coverage rate and the education level or average income of each state to try to figure out the reasons that may affect the vaccine coverage rate.

```{r summary, echo = FALSE}
summary(vac_base)
``` 

```{r map, include = FALSE} 
usa <- here("cb_2018_us_state_20m", "cb_2018_us_state_20m.shp") %>% 
  st_read()
ggplot(data = usa) +
  geom_sf()

usa_48 <- usa %>%
    filter(!(NAME %in% c("Alaska", "District of Columbia", "Hawaii", "Puerto Rico")))
ggplot(data = usa_48) +
  geom_sf()

usa_sf()
ggplot(data = usa_sf()) +
  geom_sf()

usa_fb <- usa_sf() %>%
  left_join(vac_rates, by = c("name" = "Location"))

ggplot(data = usa_fb) +
  geom_sf(aes(fill = Admin_Per_100K))
```


## Vaccination Rates vs Covid-19 cases


```{r scatterplot, echo = FALSE}
ggplot(data = rate_case, mapping = aes(x = Admin_Per_100K, y = Total_Cases)) +
  geom_point(mapping = aes(color = "black"))+
  geom_smooth() +
ggtitle("Vaccination rates vs Covid-19 cases by state")
```

```{r bar graph, echo = FALSE}
vac_base <- vac_rates %>%
  group_by(state.abb) %>% 

g <- ggplot(data = vac_base)
g + geom_col(aes(x = vac_rates , y = state.abb, fill = state.abb )) +
  ggtitle("Vaccination Rates of each U.S. State", subtitle = "Data on each U.S. state") +
  theme(legend.position="none")


```
