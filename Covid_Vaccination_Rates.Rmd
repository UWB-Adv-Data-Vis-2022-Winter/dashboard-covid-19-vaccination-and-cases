---
title: "Covid-19 Cases and Vaccination Rates"
author: "Kongtao Chen, Eric Shin, Laith Darwish"
date: "2/16/2022"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library('tidyverse') ; library('modeldata') ; library('ggplot2');
library('jsonlite') ; library('rgdal') ; library('sf'); library('extrafont') ; library('ggplot2') ; library('ggspatial');
library('patchwork') ; library('scico') ; library('dplyr'); library('flexdashboard');
library('here')
library('maps')
library('albersusa')
#in order to use the albersusa, you need to install the "remotes" package frist, and run this line of code remotes::install_github("hrbrmstr/albersusa")

options(digits = 3)
set.seed(1234)
theme_set(theme_minimal())
```

## Introduction {.tabset}

This R Markdown document demonstrates our abilities to use models for data analysis using a data set collected on Covid-19 vaccination rates, cases, and some data related to them.

```{r load data, include = FALSE}
vac_base <- read.csv("Vaccination_Base.csv", row.names=NULL)
#vac_rates <- vac_base$Admin_Per_100K
#vac_rates <- cbind(vac_base$Location, vac_base$Admin_Per_100K)
vac_rates <- vac_base %>% 
  select(State_Abbreviations, Location, Admin_Per_100K) %>% mutate(Admin_Per_100K = as.numeric(Admin_Per_100K))
total_cases <- vac_base %>% 
  select(State_Abbreviations, Location, Total_Cases)
```

### U.S. Covid-19 Vaccination rate

In this report, we examine the relationship between vaccine coverage and confirmed cases in US states. And further compare the vaccine coverage rate and the education level or average income of each state to try to figure out the reasons that may affect the vaccine coverage rate.

```{r map, echo = FALSE}
usa <- here("cb_2018_us_state_20m", "cb_2018_us_state_20m.shp") %>% 
  st_read()
usa_48 <- usa %>%
    filter(!(NAME %in% c("Alaska", "District of Columbia", "Hawaii", "Puerto Rico")))
usa_fb <- usa_sf() %>%
  left_join(vac_rates, by = c("name" = "Location"))

ggplot(data = usa_fb) +
  geom_sf(aes(fill = Admin_Per_100K)) +
scale_fill_viridis_c(option = "A", direction = -1)
```


### Vaccination Rates vs Covid-19 cases 

```{r scatterplot, echo = FALSE}
ggplot(data = vac_base, mapping = aes(x = Admin_Per_100K, y = Total_Cases)) + 
  geom_point(mapping = aes(color = "Black")) +
  geom_smooth() +
ggtitle("Vaccination rates vs Covid-19 cases by state (per 100k)") +
 xlab("Doses Administered Per 100K") +
  ylab("Total Covid-19 Cases")

```

### Vaccination Rates of Each U.S. State 

```{r bar graph, echo = FALSE}
g <- ggplot(data = vac_rates)
g + geom_col(aes(x = Admin_Per_100K, y = reorder(State_Abbreviations, Admin_Per_100K), fill = State_Abbreviations )) +
  ggtitle("Vaccination Rates of Each U.S. State", subtitle = "Data on Each U.S. state") +
  theme(legend.position="none")
```
